<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hit Algorithm - Simple Track Comparison</title>
    <link rel="stylesheet" href="/static/css/style.css?v=1765291200">
    <link rel="stylesheet" href="/static/css/wizard.css?v=1">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="main-title">THE HIT ALGORITHM</h1>
            <p class="subtitle">COMPARE YOUR TRACK IN 3 SIMPLE STEPS</p>
            <p class="status">Public Beta v.2.0 - Simplified Interface</p>
        </div>
    </header>

    <!-- Progress Indicator -->
    <div class="wizard-progress">
        <div class="progress-step active" data-step="1">
            <div class="step-number">1</div>
            <div class="step-label">Choose Reference</div>
        </div>
        <div class="progress-connector"></div>
        <div class="progress-step" data-step="2">
            <div class="step-number">2</div>
            <div class="step-label">Upload Your Track</div>
        </div>
        <div class="progress-connector"></div>
        <div class="progress-step" data-step="3">
            <div class="step-number">3</div>
            <div class="step-label">Get Recommendations</div>
        </div>
    </div>

    <!-- Main Wizard Container -->
    <div class="wizard-container">

        <!-- STEP 1: CHOOSE REFERENCE -->
        <div class="wizard-step active" id="step-1">
            <div class="step-header">
                <h2>STEP 1: Choose Your Reference</h2>
                <p class="step-description">How do you want to define the target sound you're comparing against?</p>
            </div>

            <div class="reference-options">
                <!-- Option 1: Create Playlist -->
                <div class="reference-card" data-reference="playlist">
                    <div class="card-icon">üéµ</div>
                    <h3>Create Playlist Profile</h3>
                    <p>Analyze 2-30 tracks to create a sonic profile based on multiple songs</p>
                    <div class="card-benefits">
                        <span class="benefit">‚úì Most accurate</span>
                        <span class="benefit">‚úì Captures playlist vibe</span>
                    </div>
                    <button class="btn btn-primary select-reference-btn">Select This Option</button>
                </div>

                <!-- Option 2: Load Preset -->
                <div class="reference-card" data-reference="preset">
                    <div class="card-icon">üíæ</div>
                    <h3>Load Saved Preset</h3>
                    <p>Use a previously analyzed playlist profile you've saved</p>
                    <div class="card-benefits">
                        <span class="benefit">‚úì Instant</span>
                        <span class="benefit">‚úì No re-analysis needed</span>
                    </div>
                    <button class="btn btn-primary select-reference-btn">Select This Option</button>
                </div>

                <!-- Option 3: Single Track -->
                <div class="reference-card" data-reference="single">
                    <div class="card-icon">üéß</div>
                    <h3>Single Reference Track</h3>
                    <p>Compare your track directly against one reference song (1:1 comparison)</p>
                    <div class="card-benefits">
                        <span class="benefit">‚úì Fast & simple</span>
                        <span class="benefit">‚úì Direct comparison</span>
                    </div>
                    <button class="btn btn-primary select-reference-btn">Select This Option</button>
                </div>
            </div>

            <!-- Expandable sections for each option -->
            <div id="playlist-upload-section" class="reference-upload-section" style="display: none;">
                <h3>üìÅ Upload Playlist Tracks (2-30 files)</h3>
                <div class="upload-zone" id="playlist-upload">
                    <div class="upload-icon">üìÅ</div>
                    <h4>Drag & Drop Playlist Files</h4>
                    <p>or click to browse</p>
                    <p class="file-types">Supported: MP3, WAV, FLAC</p>
                    <input type="file" id="playlist-files" multiple accept=".mp3,.wav,.flac" style="display: none;">
                </div>
                <div id="playlist-file-list" class="file-list"></div>

                <!-- Parameter Selection for Playlist Analysis -->
                <div class="parameter-selection-wizard" style="margin-top: 30px;">
                    <h3>Select Analysis Parameters</h3>
                    <p class="param-hint">Choose which parameters to analyze. More parameters = longer analysis time (~5-80s per track).</p>

                    <div class="param-quick-select">
                        <button class="btn btn-secondary btn-small" id="select-essential-playlist">Essential Only (Fast)</button>
                        <button class="btn btn-secondary btn-small" id="select-all-params-playlist">All Parameters (Thorough)</button>
                    </div>

                    <h4 class="collapsible-header" data-target="playlist-param-groups-container" style="margin-top: 20px; font-size: 14px; color: #b0b0b0;">
                        <span class="collapse-icon">‚ñ∂</span> Show all parameters
                    </h4>
                    <div id="playlist-param-groups-container" class="collapsible-content collapsed">
                        <div class="param-groups" id="playlist-param-groups">
                            <!-- Parameters will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <button id="analyze-playlist-btn" class="btn btn-secondary" disabled>Analyze Playlist ‚Üí</button>
                <div id="playlist-progress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="playlist-progress-fill"></div>
                    </div>
                    <p class="progress-text" id="playlist-progress-text">Processing...</p>
                </div>

                <!-- Playlist Results -->
                <div id="playlist-results" class="results-summary" style="display: none; margin-top: 30px;">
                    <h3>‚úì Playlist Profile Created</h3>
                    <div id="playlist-profile-display" class="param-comparison-grid"></div>
                    <div style="margin-top: 25px; display: flex; gap: 15px;">
                        <button id="save-playlist-preset-btn" class="btn btn-primary">üíæ Save as Preset</button>
                    </div>
                </div>
            </div>

            <div id="preset-load-section" class="reference-upload-section" style="display: none;">
                <h3>üìÇ Select a Saved Preset</h3>
                <div id="preset-list-display" class="preset-list">
                    <p class="placeholder">No presets saved yet</p>
                </div>
                <button id="import-preset-wizard-btn" class="btn btn-secondary">üì• Import Preset File</button>
                <input type="file" id="import-preset-wizard-file" accept=".json" style="display: none;">
            </div>

            <div id="single-upload-section" class="reference-upload-section" style="display: none;">
                <h3>üéº Upload Reference Track</h3>
                <div class="upload-zone small" id="reference-track-upload">
                    <div class="upload-icon">üéº</div>
                    <p>Drop reference track here</p>
                    <input type="file" id="reference-track-file" accept=".mp3,.wav,.flac" style="display: none;">
                </div>
                <div id="reference-track-name" class="track-name-container"></div>
                <button id="confirm-reference-btn" class="btn btn-primary" disabled>Confirm Reference & Upload Your Track ‚Üí</button>
            </div>
        </div>

        <!-- STEP 2: UPLOAD YOUR TRACK -->
        <div class="wizard-step" id="step-2" style="display: none;">
            <div class="step-header">
                <h2>STEP 2: Upload Your Track</h2>
                <p class="step-description">Now upload the track you want to analyze and compare</p>
            </div>

            <div class="upload-zone large" id="user-track-upload">
                <div class="upload-icon">üéµ</div>
                <h3>Drag & Drop Your Track Here</h3>
                <p>or click to browse</p>
                <p class="file-types">Supported: MP3, WAV, FLAC</p>
                <input type="file" id="user-track-file" accept=".mp3,.wav,.flac" style="display: none;">
            </div>

            <div id="user-track-name" class="track-name-container"></div>

            <!-- Parameter Selection -->
            <div class="parameter-selection-wizard">
                <h3>Select Parameters to Analyze</h3>
                <p class="param-hint">Choose which audio parameters to compare. More parameters = longer analysis time.</p>

                <div class="param-quick-select">
                    <button class="btn btn-secondary btn-small" id="select-essential">Essential Only (Fast)</button>
                    <button class="btn btn-secondary btn-small" id="select-all-params">All Parameters (Thorough)</button>
                </div>

                <h4 class="collapsible-header" data-target="wizard-param-groups-container" style="margin-top: 20px; font-size: 14px; color: #b0b0b0;">
                    <span class="collapse-icon">‚ñ∂</span> Show all parameters
                </h4>
                <div id="wizard-param-groups-container" class="collapsible-content collapsed">
                    <div class="param-groups" id="wizard-param-groups">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="wizard-navigation">
                <button class="btn btn-secondary" id="back-to-step-1">‚Üê Back</button>
                <button class="btn btn-primary" id="compare-now-btn" disabled>Compare Now ‚Üí</button>
            </div>

            <div id="comparison-progress" class="progress-container" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="comparison-progress-fill"></div>
                </div>
                <p class="progress-text" id="comparison-progress-text">Analyzing...</p>
            </div>
        </div>

        <!-- STEP 3: RESULTS & RECOMMENDATIONS -->
        <div class="wizard-step" id="step-3" style="display: none;">
            <div class="step-header">
                <h2>STEP 3: Results & AI Recommendations</h2>
                <p class="step-description">Here's how your track compares and what you can improve</p>
            </div>

            <div id="results-container" class="results-container">
                <!-- Results will be populated by JavaScript -->
                <div class="results-summary">
                    <h3>üìä Comparison Summary</h3>
                    <div id="comparison-summary"></div>
                </div>

                <div class="recommendations-section">
                    <h3>üí° AI Recommendations</h3>
                    <p class="recommendations-intro">Based on the analysis, here's what you can improve:</p>
                    <div id="ai-recommendations"></div>
                </div>
            </div>

            <div class="wizard-navigation">
                <button class="btn btn-secondary" id="start-over-btn">üîÑ Start Over</button>
                <button class="btn btn-primary" id="export-report-btn">üìÑ Export Report</button>
            </div>
        </div>

    </div>

    <!-- Session Data (hidden) -->
    <div id="session-data" style="display: none;">
        <span id="session-id"></span>
        <span id="wizard-reference-type"></span>
        <span id="wizard-reference-ready">false</span>
    </div>

    <!-- Progress Modal -->
    <div id="progress-modal" class="progress-modal-overlay" style="display: none;">
        <div class="progress-modal-content">
            <div class="progress-modal-header">
                <div class="progress-spinner"></div>
                <h3 id="progress-modal-title">Processing Audio...</h3>
            </div>
            <div class="progress-modal-body">
                <div class="progress-bar-modal">
                    <div class="progress-fill-modal" id="progress-fill-modal"></div>
                </div>
                <p class="progress-message-modal" id="progress-message-modal">Initializing...</p>
            </div>
        </div>
    </div>

    <!-- Save Preset Modal -->
    <div id="save-preset-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>üíæ Save Playlist as Preset</h3>
            <p>Enter a name for this playlist profile:</p>
            <input type="text" id="preset-name-input-wizard" placeholder="e.g., Top 40 Hits 2024" maxlength="50">
            <div class="modal-buttons">
                <button id="preset-save-confirm-wizard" class="btn btn-primary">SAVE</button>
                <button id="preset-save-cancel-wizard" class="btn btn-secondary">CANCEL</button>
            </div>
        </div>
    </div>

    <script src="/static/js/wizard.js?v=1"></script>
</body>
</html>
