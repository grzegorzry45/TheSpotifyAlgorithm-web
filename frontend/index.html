<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hit Algorithm - Spotify Playlist Analyzer</title>
    <link rel="stylesheet" href="/static/css/style.css?v=1765291200">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="main-title">THE HIT ALGORITHM </h1>
            <p class="subtitle">DECODE YOUR REFERENCE TRACKS</p>
            <p class="status"> Public Beta v.118 by GR</p>
        </div>
        <!-- TEMPORARILY DISABLED: Authentication suspended for public beta -->
        <div class="auth-buttons" style="display: none;">
            <button id="login-btn" class="btn btn-secondary">Login</button>
            <button id="register-btn" class="btn btn-primary">Register</button>
            <button id="logout-btn" class="btn btn-secondary" style="display: none;">Logout</button>
        </div>
    </header>

    <!-- Main App Content -->
    <!-- TEMPORARILY DISABLED: Authentication suspended - content now visible by default -->
    <div id="main-app-content">
        <!-- Main Container -->
        <div class="container">
            <!-- Tab Navigation -->
            <nav class="tabs">
                <button class="tab-btn" data-tab="analyze">üéµ Your Own Playlist</button>
                <button class="tab-btn" data-tab="library">üìö Your Songs</button>
                <button class="tab-btn active" data-tab="compare">‚öñÔ∏è Compare Your Track</button>
                <button class="tab-btn" data-tab="recommendations">‚ú® Recommendations</button>
            </nav>

            <!-- Tab Content -->
            <div class="tab-content-wrapper">

            <!-- ANALYZE PLAYLIST TAB -->
            <div id="analyze-tab" class="tab-content">
                <div class="section-header">
                    <h2>ANALYZE TARGET PLAYLIST</h2>
                    <p>Upload 2-30 tracks from your target playlist to create a sonic profile</p>
                </div>

                <!-- Parameter Selection -->
                <div class="parameter-selection">
                    <h3 class="collapsible-header" data-target="analyze-params-content">Select Analysis Parameters <span class="collapse-icon">‚ñº</span></h3>
                    <div id="analyze-params-content" class="collapsible-content collapsed">
                        <p class="param-hint">Choose which parameters to analyze. More parameters = slower analysis (~5-80s/track depending on selection)</p>

                        <div class="param-groups" id="param-groups">
                            <div class="param-group">
                                <h4>üéµ Tier 1: Spectral (Fast) <span class="param-time">+3-5s</span></h4>
                                <label><input type="checkbox" name="param" value="spectral_rolloff"> Spectral Rolloff</label>
                                <label><input type="checkbox" name="param" value="spectral_flatness"> Spectral Flatness</label>
                                <label><input type="checkbox" name="param" value="zero_crossing_rate"> Zero Crossing Rate</label>
                            </div>

                            <div class="param-group">
                                <h4>üéöÔ∏è Tier 1B: Energy Distribution (Fast) <span class="param-time">+2-5s</span></h4>
                                <label><input type="checkbox" name="param" value="low_energy"> Low Energy (20-250Hz)</label>
                                <label><input type="checkbox" name="param" value="mid_energy"> Mid Energy (250Hz-4kHz)</label>
                                <label><input type="checkbox" name="param" value="high_energy"> High Energy (4kHz+)</label>
                            </div>

                            <div class="param-group">
                                <h4>üéπ Tier 2: Perceptual (Medium) <span class="param-time">+5-15s</span></h4>
                                <label><input type="checkbox" name="param" value="danceability"> Danceability</label>
                                <label><input type="checkbox" name="param" value="beat_strength"> Beat Strength</label>
                                <label><input type="checkbox" name="param" value="sub_bass_presence"> Sub-Bass Presence</label>
                                <label><input type="checkbox" name="param" value="stereo_width"> Stereo Width</label>
                                <label><input type="checkbox" name="param" value="valence"> Valence (Mood)</label>
                                <label><input type="checkbox" name="param" value="key_confidence"> Key Confidence</label>
                            </div>

                            <div class="param-group">
                                <h4>üéöÔ∏è Tier 3: Production (Slow) <span class="param-time">+10-25s</span></h4>
                                <label><input type="checkbox" name="param" value="loudness_range"> Loudness Range (LRA)</label>
                                <label><input type="checkbox" name="param" value="true_peak"> True Peak</label>
                                <label><input type="checkbox" name="param" value="crest_factor"> Crest Factor</label>
                                <label><input type="checkbox" name="param" value="spectral_contrast"> Spectral Contrast</label>
                                <label><input type="checkbox" name="param" value="transient_energy"> Transient Energy</label>
                                <label><input type="checkbox" name="param" value="harmonic_to_noise_ratio"> Harmonic/Noise Ratio</label>
                            </div>

                            <div class="param-group">
                                <h4>üéº Tier 4: Compositional (Very Slow) <span class="param-time">+35-80s</span></h4>
                                <label><input type="checkbox" name="param" value="harmonic_complexity"> Harmonic Complexity</label>
                                <label><input type="checkbox" name="param" value="melodic_range"> Melodic Range</label>
                                <label><input type="checkbox" name="param" value="rhythmic_density"> Rhythmic Density</label>
                                <label><input type="checkbox" name="param" value="arrangement_density"> Arrangement Density</label>
                                <label><input type="checkbox" name="param" value="repetition_score"> Repetition Score</label>
                                <label><input type="checkbox" name="param" value="frequency_occupancy"> Frequency Occupancy</label>
                                <label><input type="checkbox" name="param" value="timbral_diversity"> Timbral Diversity</label>
                                <label><input type="checkbox" name="param" value="vocal_instrumental_ratio"> Vocal/Instrumental</label>
                                <label><input type="checkbox" name="param" value="energy_curve"> Energy Curve</label>
                                <label><input type="checkbox" name="param" value="call_response_presence"> Call-Response</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="upload-zone" id="playlist-upload">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Drag & Drop Playlist Files</h3>
                    <p>or click to browse</p>
                    <p class="file-types">Supported: MP3, WAV, FLAC</p>
                    <input type="file" id="playlist-files" multiple accept=".mp3,.wav,.flac" style="display: none;">
                </div>

                <div id="playlist-file-list" class="file-list"></div>

                <button id="analyze-playlist-btn" class="btn btn-primary" disabled>
                    ANALYZE PLAYLIST
                </button>

                <div id="playlist-progress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="playlist-progress-fill"></div>
                    </div>
                    <p class="progress-text" id="playlist-progress-text">Processing...</p>
                    <button id="cancel-playlist-btn" class="btn btn-cancel">Cancel Analysis</button>
                    <div class="progress-stages" id="playlist-progress-stages">
                        <div class="progress-stage pending" data-stage="upload">
                            <span class="progress-stage-icon">üì§</span>
                            <span class="progress-stage-text">Uploading files to server</span>
                        </div>
                        <div class="progress-stage pending" data-stage="analyze">
                            <span class="progress-stage-icon">üîä</span>
                            <span class="progress-stage-text">Analyzing audio features</span>
                        </div>
                        <div class="progress-stage pending" data-stage="profile">
                            <span class="progress-stage-icon">üìä</span>
                            <span class="progress-stage-text">Creating sonic profile</span>
                        </div>
                        <div class="progress-stage pending" data-stage="complete">
                            <span class="progress-stage-icon">‚úì</span>
                            <span class="progress-stage-text">Analysis complete</span>
                        </div>
                    </div>
                </div>

                <div id="playlist-results" class="results-panel" style="display: none;">
                    <h3>PLAYLIST PROFILE</h3>
                    <div id="playlist-profile-data" class="profile-data"></div>

                    <button id="save-preset-btn" class="btn btn-secondary">
                        üíæ SAVE AS PRESET
                    </button>
                </div>

                <!-- PRESETS SECTION -->
                <div class="presets-section">
                    <h3>üìÅ SAVED PRESETS</h3>
                    <p class="presets-hint">Save analyzed playlists as presets for quick comparison later</p>
                    <div style="margin-bottom: 15px;">
                        <button id="import-preset-btn" class="btn btn-secondary" style="padding: 8px 16px; font-size: 12px;">üì• IMPORT PRESET</button>
                        <input type="file" id="import-preset-file" accept=".json" style="display: none;">
                    </div>
                    <div id="presets-list" class="presets-list">
                        <p class="placeholder">No presets saved yet. Analyze a playlist and save it!</p>
                    </div>
                </div>
            </div>

            <!-- YOUR LIBRARY TAB -->
            <div id="library-tab" class="tab-content">
                <div class="section-header">
                    <h2>YOUR TRACKS</h2>
                    <p>Upload your tracks to compare against the target playlist</p>
                </div>

                <div class="upload-zone" id="user-tracks-upload">
                    <div class="upload-icon">üéµ</div>
                    <h3>Drag & Drop Your Tracks</h3>
                    <p>or click to browse</p>
                    <p class="file-types">Supported: MP3, WAV, FLAC</p>
                    <input type="file" id="user-track-files" multiple accept=".mp3,.wav,.flac" style="display: none;">
                </div>

                <div id="user-file-list" class="file-list"></div>

                <button id="compare-batch-btn" class="btn btn-primary" disabled>
                    ANALYZE & COMPARE
                </button>

                <div id="batch-progress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="batch-progress-fill"></div>
                    </div>
                    <p class="progress-text" id="batch-progress-text">Processing...</p>
                    <button id="cancel-batch-btn" class="btn btn-cancel">Cancel Comparison</button>
                    <div class="progress-stages" id="batch-progress-stages">
                        <div class="progress-stage pending" data-stage="upload">
                            <span class="progress-stage-icon">üì§</span>
                            <span class="progress-stage-text">Uploading your tracks</span>
                        </div>
                        <div class="progress-stage pending" data-stage="analyze">
                            <span class="progress-stage-icon">üîä</span>
                            <span class="progress-stage-text">Analyzing audio features</span>
                        </div>
                        <div class="progress-stage pending" data-stage="compare">
                            <span class="progress-stage-icon">‚öñÔ∏è</span>
                            <span class="progress-stage-text">Comparing vs playlist profile</span>
                        </div>
                        <div class="progress-stage pending" data-stage="recommendations">
                            <span class="progress-stage-icon">üí°</span>
                            <span class="progress-stage-text">Generating recommendations</span>
                        </div>
                        <div class="progress-stage pending" data-stage="complete">
                            <span class="progress-stage-icon">‚úì</span>
                            <span class="progress-stage-text">Comparison complete</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- COMPARE TAB -->
            <div id="compare-tab" class="tab-content active">
                <div class="section-header">
                    <h2>SINGLE TRACK COMPARE</h2>
                    <p>Compare one track vs playlist or 1:1 track comparison</p>
                </div>

                <div class="compare-mode-selector">
                    <label class="radio-label">
                        <input type="radio" name="compare-mode" value="playlist" checked>
                        <span>vs Playlist</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="compare-mode" value="track">
                        <span>1:1 Track Compare</span>
                    </label>
                </div>

                <!-- PRESETS SECTION FOR COMPARE -->
                <div class="presets-section" id="compare-presets-section">
                    <h3>üìÅ LOAD PLAYLIST PRESET</h3>
                    <p class="presets-hint">Load a saved playlist profile to compare your track against</p>
                    <button id="show-preset-modal-btn" class="btn btn-primary">üìÇ Load Playlist Preset</button>
                    <div id="active-preset-info" class="active-preset-info" style="display: none;">
                        <span class="active-preset-label">Active Preset:</span>
                        <span class="active-preset-name" id="active-preset-name"></span>
                        <button class="preset-btn clear" id="clear-preset-btn">‚úï Clear</button>
                    </div>
                </div>

                <!-- Parameter Selection for Compare -->
                <div class="parameter-selection">
                    <h3 class="collapsible-header" data-target="compare-params-content">Select Analysis Parameters <span class="collapse-icon">‚ñº</span></h3>
                    <div id="compare-params-content" class="collapsible-content collapsed">
                        <p class="param-hint">Choose which parameters to analyze. More parameters = slower analysis (~5-80s/track depending on selection)</p>

                        <div class="param-groups" id="param-groups-compare">
                            <div class="param-group">
                                <h4>üéµ Tier 1: Spectral (Fast) <span class="param-time">+3-5s</span></h4>
                                <label><input type="checkbox" name="param-compare" value="spectral_rolloff"> Spectral Rolloff</label>
                                <label><input type="checkbox" name="param-compare" value="spectral_flatness"> Spectral Flatness</label>
                                <label><input type="checkbox" name="param-compare" value="zero_crossing_rate"> Zero Crossing Rate</label>
                            </div>

                            <div class="param-group">
                                <h4>üéöÔ∏è Tier 1B: Energy Distribution (Fast) <span class="param-time">+2-5s</span></h4>
                                <label><input type="checkbox" name="param-compare" value="low_energy"> Low Energy (20-250Hz)</label>
                                <label><input type="checkbox" name="param-compare" value="mid_energy"> Mid Energy (250Hz-4kHz)</label>
                                <label><input type="checkbox" name="param-compare" value="high_energy"> High Energy (4kHz+)</label>
                            </div>

                            <div class="param-group">
                                <h4>üéπ Tier 2: Perceptual (Medium) <span class="param-time">+5-15s</span></h4>
                                <label><input type="checkbox" name="param-compare" value="danceability"> Danceability</label>
                                <label><input type="checkbox" name="param-compare" value="beat_strength"> Beat Strength</label>
                                <label><input type="checkbox" name="param-compare" value="sub_bass_presence"> Sub-Bass Presence</label>
                                <label><input type="checkbox" name="param-compare" value="stereo_width"> Stereo Width</label>
                                <label><input type="checkbox" name="param-compare" value="valence"> Valence (Mood)</label>
                                <label><input type="checkbox" name="param-compare" value="key_confidence"> Key Confidence</label>
                            </div>

                            <div class="param-group">
                                <h4>üéöÔ∏è Tier 3: Production (Slow) <span class="param-time">+10-25s</span></h4>
                                <label><input type="checkbox" name="param-compare" value="loudness_range"> Loudness Range (LRA)</label>
                                <label><input type="checkbox" name="param-compare" value="true_peak"> True Peak</label>
                                <label><input type="checkbox" name="param-compare" value="crest_factor"> Crest Factor</label>
                                <label><input type="checkbox" name="param-compare" value="spectral_contrast"> Spectral Contrast</label>
                                <label><input type="checkbox" name="param-compare" value="transient_energy"> Transient Energy</label>
                                <label><input type="checkbox" name="param-compare" value="harmonic_to_noise_ratio"> Harmonic/Noise Ratio</label>
                            </div>

                            <div class="param-group">
                                <h4>üéº Tier 4: Compositional (Very Slow) <span class="param-time">+35-80s</span></h4>
                                <label><input type="checkbox" name="param-compare" value="harmonic_complexity"> Harmonic Complexity</label>
                                <label><input type="checkbox" name="param-compare" value="melodic_range"> Melodic Range</label>
                                <label><input type="checkbox" name="param-compare" value="rhythmic_density"> Rhythmic Density</label>
                                <label><input type="checkbox" name="param-compare" value="arrangement_density"> Arrangement Density</label>
                                <label><input type="checkbox" name="param-compare" value="repetition_score"> Repetition Score</label>
                                <label><input type="checkbox" name="param-compare" value="frequency_occupancy"> Frequency Occupancy</label>
                                <label><input type="checkbox" name="param-compare" value="timbral_diversity"> Timbral Diversity</label>
                                <label><input type="checkbox" name="param-compare" value="vocal_instrumental_ratio"> Vocal/Instrumental</label>
                                <label><input type="checkbox" name="param-compare" value="energy_curve"> Energy Curve</label>
                                <label><input type="checkbox" name="param-compare" value="call_response_presence"> Call-Response</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="compare-grid">
                    <div class="compare-section">
                        <h3>YOUR TRACK</h3>
                        <div class="upload-zone small" id="user-single-upload">
                            <div class="upload-icon">üéß</div>
                            <p>Drop your track here</p>
                            <input type="file" id="user-single-file" accept=".mp3,.wav,.flac" style="display: none;">
                        </div>
                        <div id="user-single-name" class="track-name-container"></div>
                    </div>

                    <div class="compare-section" id="reference-section" style="display: none;">
                        <h3>REFERENCE TRACK</h3>
                        <div class="upload-zone small" id="reference-upload">
                            <div class="upload-icon">üéº</div>
                            <p>Drop reference track</p>
                            <input type="file" id="reference-file" accept=".mp3,.wav,.flac" style="display: none;">
                        </div>
                        <div id="reference-name" class="track-name-container"></div>
                    </div>
                </div>

                <button id="compare-single-btn" class="btn btn-primary" disabled>
                    COMPARE TRACKS
                </button>

                <div id="compare-progress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="compare-progress-fill"></div>
                    </div>
                    <p class="progress-text" id="compare-progress-text">Analyzing...</p>
                    <button id="cancel-compare-btn" class="btn btn-cancel">Cancel Comparison</button>
                    <div class="progress-stages" id="compare-progress-stages">
                        <div class="progress-stage pending" data-stage="upload">
                            <span class="progress-stage-icon">üì§</span>
                            <span class="progress-stage-text">Uploading tracks</span>
                        </div>
                        <div class="progress-stage pending" data-stage="analyze-user">
                            <span class="progress-stage-icon">üéß</span>
                            <span class="progress-stage-text">Analyzing your track</span>
                        </div>
                        <div class="progress-stage pending" data-stage="analyze-ref">
                            <span class="progress-stage-icon">üéº</span>
                            <span class="progress-stage-text">Analyzing reference track</span>
                        </div>
                        <div class="progress-stage pending" data-stage="compare">
                            <span class="progress-stage-icon">‚öñÔ∏è</span>
                            <span class="progress-stage-text">Comparing parameters</span>
                        </div>
                        <div class="progress-stage pending" data-stage="complete">
                            <span class="progress-stage-icon">‚úì</span>
                            <span class="progress-stage-text">Comparison complete</span>
                        </div>
                    </div>
                </div>

                <div id="compare-results" class="results-panel" style="display: none;">
                    <h3>COMPARISON RESULTS</h3>
                    <div id="compare-data" class="comparison-data"></div>
                </div>
            </div>

            <!-- RECOMMENDATIONS TAB -->
            <div id="recommendations-tab" class="tab-content">
                <div class="section-header">
                    <h2>AI RECOMMENDATIONS</h2>
                    <p>Actionable suggestions to match your target playlist</p>
                </div>

                <div id="recommendations-list" class="recommendations-panel">
                    <p class="placeholder">Run a comparison to see recommendations</p>
                </div>

                <button id="generate-report-btn" class="btn btn-secondary" style="display: none;">
                    EXPORT HTML REPORT
                </button>
            </div>

        </div>
    </div>

    <!-- Preset Name Modal -->
    <div id="preset-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>üíæ Save Preset</h3>
            <p>Enter a name for this playlist profile:</p>
            <input type="text" id="preset-name-input" placeholder="e.g., Top 40 Hits 2024" maxlength="50">
            <div class="modal-buttons">
                <button id="preset-save-confirm" class="btn btn-primary">SAVE</button>
                <button id="preset-save-cancel" class="btn btn-secondary">CANCEL</button>
            </div>
        </div>
    </div>

    <!-- Rename Preset Modal -->
    <div id="rename-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>‚úèÔ∏è Rename Preset</h3>
            <p>Enter new name:</p>
            <input type="text" id="rename-input" placeholder="New preset name" maxlength="50">
            <div class="modal-buttons">
                <button id="rename-confirm" class="btn btn-primary">SAVE</button>
                <button id="rename-cancel" class="btn btn-secondary">CANCEL</button>
            </div>
        </div>
    </div>

    <!-- Load Preset Modal -->
    <div id="load-preset-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>üìÇ Load Preset</h3>
            <p>Select a saved playlist profile to load:</p>
            <div id="modal-presets-list" class="presets-list modal-list">
                <!-- Presets will be dynamically inserted here -->
                <p class="placeholder">No presets saved yet.</p>
            </div>
            <div class="modal-buttons">
                <button id="load-preset-cancel" class="btn btn-secondary">CANCEL</button>
            </div>
        </div>
    </div>

    <!-- Session Info (hidden) -->
    <div id="session-data" style="display: none;">
        <span id="session-id"></span>
        <span id="has-playlist-profile">false</span>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>üîë Login</h3>
            <div class="auth-form">
                <input type="email" id="login-email" placeholder="Email" required>
                <input type="password" id="login-password" placeholder="Password" required>
                <p id="login-error" class="error-message"></p>
                <div class="modal-buttons">
                    <button id="login-confirm" class="btn btn-primary">LOGIN</button>
                    <button id="login-cancel" class="btn btn-secondary">CANCEL</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>üìù Register</h3>
            <div class="auth-form">
                <input type="email" id="register-email" placeholder="Email" required>
                <input type="password" id="register-password" placeholder="Password" required>
                <input type="password" id="register-password-confirm" placeholder="Confirm Password" required>
                <p id="register-error" class="error-message"></p>
                <div class="modal-buttons">
                    <button id="register-confirm" class="btn btn-primary">REGISTER</button>
                    <button id="register-cancel" class="btn btn-secondary">CANCEL</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js?v=1765291200"></script>
</body>
</html>
